# Malware Scan MCP Server

This MCP server provides integration with VirusTotal and Hybrid Analysis for malware scanning and analysis. It allows you to scan files using both services through a unified interface.

## Features

- File scanning with VirusTotal
- Dynamic analysis with Hybrid Analysis sandbox
- Support for multiple sandbox environments
- Detailed scan reports and analysis results

## Setup

1. Install dependencies:
```bash
npm install
```

2. Create a `.env` file in the parent directory with your API keys:
```env
VT_API_KEY=your_virustotal_api_key
HA_API_KEY=your_hybrid_analysis_api_key
```

3. Build the server:
```bash
npm run build
```

## Usage

The server provides two main tools:

### 1. VirusTotal Scan
Scans files using VirusTotal's multi-engine malware detection:

```json
{
  "name": "virustotal_scan",
  "arguments": {
    "file_path": "/path/to/file"
  }
}
```

### 2. Hybrid Analysis Scan
Performs dynamic analysis in a sandbox environment:

```json
{
  "name": "hybrid_analysis_scan",
  "arguments": {
    "file_path": "/path/to/file",
    "environment_id": 140  // Optional, defaults to Windows 10 64-bit
  }
}
```

## Environment IDs

Common Hybrid Analysis environment IDs:
- 140: Windows 10 64-bit
- 120: Windows 7 64-bit
- 300: Linux Ubuntu 16.04 64-bit

## Development

To watch for changes during development:
```bash
npm run watch
```

## License

MIT 